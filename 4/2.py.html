<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>2.py</title>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body class="hl">
<pre class="hl"><span class="hl lin">    1 </span><span class="hl kwa">from</span> itertools <span class="hl kwa">import</span> islice
<span class="hl lin">    2 </span>
<span class="hl lin">    3 </span><span class="hl kwa">import</span> numpy <span class="hl kwa">as</span> np
<span class="hl lin">    4 </span>
<span class="hl lin">    5 </span>
<span class="hl lin">    6 </span><span class="hl kwa">def</span> <span class="hl kwd">main</span><span class="hl opt">():</span>
<span class="hl lin">    7 </span>    draws_all<span class="hl opt">,</span> boards_all <span class="hl opt">=</span> <span class="hl kwd">parse_input</span><span class="hl opt">()</span>
<span class="hl lin">    8 </span>
<span class="hl lin">    9 </span>    boards_wining_last<span class="hl opt">,</span> draws_winning_last <span class="hl opt">=</span> \
<span class="hl lin">   10 </span>        <span class="hl kwd">get_last_winning_board_and_draw</span><span class="hl opt">(</span>boards_all<span class="hl opt">,</span> draws_all<span class="hl opt">)</span>
<span class="hl lin">   11 </span>
<span class="hl lin">   12 </span>    draws_winning_last_number <span class="hl opt">=</span> draws_winning_last<span class="hl opt">[-</span><span class="hl num">1</span><span class="hl opt">]</span>
<span class="hl lin">   13 </span>
<span class="hl lin">   14 </span>    boards_winning_last_sum <span class="hl opt">=</span> <span class="hl kwd">sum_of_unmarked_fields</span><span class="hl opt">(</span>boards_wining_last<span class="hl opt">,</span> draws_winning_last<span class="hl opt">)</span>
<span class="hl lin">   15 </span>
<span class="hl lin">   16 </span>    <span class="hl kwa">print</span><span class="hl opt">(</span>boards_winning_last_sum <span class="hl opt">*</span> draws_winning_last_number<span class="hl opt">)</span>  <span class="hl slc"># 7686</span>
<span class="hl lin">   17 </span>
<span class="hl lin">   18 </span>
<span class="hl lin">   19 </span><span class="hl kwa">def</span> <span class="hl kwd">get_last_winning_board_and_draw</span><span class="hl opt">(</span>boards_all<span class="hl opt">,</span> draws_all<span class="hl opt">):</span>
<span class="hl lin">   20 </span>    <span class="hl sng">&quot;&quot;&quot;</span>
<span class="hl lin">   21 </span><span class="hl sng"></span>
<span class="hl lin">   22 </span><span class="hl sng">    :param boards_all: All boards that should be checked</span>
<span class="hl lin">   23 </span><span class="hl sng">    :param draws_all: All draws that can lead to a board winning</span>
<span class="hl lin">   24 </span><span class="hl sng">    :return: (The last winning board, The draws that made the last winning board winning)</span>
<span class="hl lin">   25 </span><span class="hl sng">    &quot;&quot;&quot;</span>
<span class="hl lin">   26 </span>    boards_winning<span class="hl opt">,</span> draws_winning <span class="hl opt">=</span> <span class="hl kwd">get_winning_boards_and_draws</span><span class="hl opt">(</span>boards_all<span class="hl opt">,</span> draws_all<span class="hl opt">)</span>
<span class="hl lin">   27 </span>
<span class="hl lin">   28 </span>    <span class="hl slc"># assure that data is consistent</span>
<span class="hl lin">   29 </span>    last_winning_board_draw_index <span class="hl opt">=</span> <span class="hl kwb">max</span><span class="hl opt">(</span>boards_winning<span class="hl opt">.</span><span class="hl kwd">keys</span><span class="hl opt">())</span>
<span class="hl lin">   30 </span>    last_winning_draw_draw_index <span class="hl opt">=</span> <span class="hl kwb">max</span><span class="hl opt">(</span>draws_winning<span class="hl opt">.</span><span class="hl kwd">keys</span><span class="hl opt">())</span>
<span class="hl lin">   31 </span>    <span class="hl kwa">assert</span> last_winning_board_draw_index <span class="hl opt">==</span> last_winning_draw_draw_index
<span class="hl lin">   32 </span>
<span class="hl lin">   33 </span>    boards_winning_last <span class="hl opt">=</span> boards_winning<span class="hl opt">.</span><span class="hl kwd">get</span><span class="hl opt">(</span>last_winning_board_draw_index<span class="hl opt">)</span>
<span class="hl lin">   34 </span>    draws_winning_last <span class="hl opt">=</span> draws_winning<span class="hl opt">.</span><span class="hl kwd">get</span><span class="hl opt">(</span>last_winning_draw_draw_index<span class="hl opt">)</span>
<span class="hl lin">   35 </span>
<span class="hl lin">   36 </span>    <span class="hl slc"># There might be more than one last winning board</span>
<span class="hl lin">   37 </span>    <span class="hl kwa">if</span> <span class="hl kwb">len</span><span class="hl opt">(</span>boards_winning_last<span class="hl opt">) !=</span> <span class="hl num">1</span> <span class="hl kwa">and</span> <span class="hl kwb">len</span><span class="hl opt">(</span>draws_winning_last<span class="hl opt">) !=</span> <span class="hl num">1</span><span class="hl opt">:</span>
<span class="hl lin">   38 </span>        <span class="hl slc"># This would have to be handled correct...</span>
<span class="hl lin">   39 </span>        <span class="hl kwa">raise</span> <span class="hl kwc">NotImplementedError</span>
<span class="hl lin">   40 </span>
<span class="hl lin">   41 </span>    <span class="hl kwa">return</span> boards_winning_last<span class="hl opt">[</span><span class="hl num">0</span><span class="hl opt">],</span> draws_winning_last<span class="hl opt">[</span><span class="hl num">0</span><span class="hl opt">]</span>
<span class="hl lin">   42 </span>
<span class="hl lin">   43 </span>
<span class="hl lin">   44 </span><span class="hl kwa">def</span> <span class="hl kwd">get_winning_boards_and_draws</span><span class="hl opt">(</span>boards_all<span class="hl opt">,</span> draws_all<span class="hl opt">):</span>
<span class="hl lin">   45 </span>    <span class="hl sng">&quot;&quot;&quot;</span>
<span class="hl lin">   46 </span><span class="hl sng">    Get all winning boards and the draws that made those boards win</span>
<span class="hl lin">   47 </span><span class="hl sng">    </span>
<span class="hl lin">   48 </span><span class="hl sng">    :param boards_all: All boards that should be checked</span>
<span class="hl lin">   49 </span><span class="hl sng">    :param draws_all: All draws that can lead to a board winning</span>
<span class="hl lin">   50 </span><span class="hl sng">    :return: (All winning boards, All the draws that made those boards winning)</span>
<span class="hl lin">   51 </span><span class="hl sng">    &quot;&quot;&quot;</span>
<span class="hl lin">   52 </span>    boards_winning <span class="hl opt">= {}</span>
<span class="hl lin">   53 </span>    draws_winning <span class="hl opt">= {}</span>
<span class="hl lin">   54 </span>    <span class="hl kwa">for</span> board <span class="hl kwa">in</span> boards_all<span class="hl opt">:</span>
<span class="hl lin">   55 </span>        draws <span class="hl opt">= []</span>
<span class="hl lin">   56 </span>        <span class="hl kwa">for</span> draw <span class="hl kwa">in</span> draws_all<span class="hl opt">:</span>
<span class="hl lin">   57 </span>            draws<span class="hl opt">.</span><span class="hl kwd">append</span><span class="hl opt">(</span>draw<span class="hl opt">)</span>
<span class="hl lin">   58 </span>
<span class="hl lin">   59 </span>            draw_count <span class="hl opt">=</span> <span class="hl kwb">len</span><span class="hl opt">(</span>draws<span class="hl opt">)</span>
<span class="hl lin">   60 </span>
<span class="hl lin">   61 </span>            <span class="hl slc"># dont investigate impossible cases</span>
<span class="hl lin">   62 </span>            <span class="hl kwa">if</span> draw_count <span class="hl opt">&lt;</span> <span class="hl num">5</span><span class="hl opt">:</span>
<span class="hl lin">   63 </span>                <span class="hl kwa">continue</span>
<span class="hl lin">   64 </span>
<span class="hl lin">   65 </span>            <span class="hl kwa">if</span> <span class="hl kwd">is_board_winning</span><span class="hl opt">(</span>board<span class="hl opt">,</span> draws<span class="hl opt">):</span>
<span class="hl lin">   66 </span>                <span class="hl slc"># create data structure if not available</span>
<span class="hl lin">   67 </span>                <span class="hl kwa">if not</span> boards_winning<span class="hl opt">.</span><span class="hl kwd">get</span><span class="hl opt">(</span>draw_count<span class="hl opt">):</span>
<span class="hl lin">   68 </span>                    boards_winning<span class="hl opt">[</span>draw_count<span class="hl opt">] = []</span>
<span class="hl lin">   69 </span>                    draws_winning<span class="hl opt">[</span>draw_count<span class="hl opt">] = []</span>
<span class="hl lin">   70 </span>
<span class="hl lin">   71 </span>                <span class="hl slc"># two independent data structures are probably not the best solution for this</span>
<span class="hl lin">   72 </span>                <span class="hl slc"># but it works ¯\_(ツ)_/¯</span>
<span class="hl lin">   73 </span>                boards_winning<span class="hl opt">[</span>draw_count<span class="hl opt">].</span><span class="hl kwd">append</span><span class="hl opt">(</span>board<span class="hl opt">)</span>
<span class="hl lin">   74 </span>                draws_winning<span class="hl opt">[</span>draw_count<span class="hl opt">].</span><span class="hl kwd">append</span><span class="hl opt">(</span>draws<span class="hl opt">)</span>
<span class="hl lin">   75 </span>
<span class="hl lin">   76 </span>                <span class="hl kwa">break</span>
<span class="hl lin">   77 </span>
<span class="hl lin">   78 </span>    <span class="hl kwa">return</span> boards_winning<span class="hl opt">,</span> draws_winning
<span class="hl lin">   79 </span>
<span class="hl lin">   80 </span>
<span class="hl lin">   81 </span><span class="hl kwa">def</span> <span class="hl kwd">parse_input</span><span class="hl opt">():</span>
<span class="hl lin">   82 </span>    <span class="hl sng">&quot;&quot;&quot;parse input to numbers drawn and boards available&quot;&quot;&quot;</span>
<span class="hl lin">   83 </span>
<span class="hl lin">   84 </span>    with <span class="hl kwb">open</span><span class="hl opt">(</span><span class="hl sng">&quot;input&quot;</span><span class="hl opt">)</span> <span class="hl kwa">as</span> lines<span class="hl opt">:</span>
<span class="hl lin">   85 </span>
<span class="hl lin">   86 </span>        <span class="hl slc"># first line contains all draws</span>
<span class="hl lin">   87 </span>        draws_all <span class="hl opt">= [</span><span class="hl kwb">int</span><span class="hl opt">(</span>x<span class="hl opt">)</span> <span class="hl kwa">for</span> x <span class="hl kwa">in</span> lines<span class="hl opt">.</span><span class="hl kwd">readline</span><span class="hl opt">().</span><span class="hl kwd">split</span><span class="hl opt">(</span>sep<span class="hl opt">=</span><span class="hl sng">&quot;,&quot;</span><span class="hl opt">)]</span>
<span class="hl lin">   88 </span>
<span class="hl lin">   89 </span>        <span class="hl slc"># extract all the boards from remaining input</span>
<span class="hl lin">   90 </span>        boards <span class="hl opt">= []</span>
<span class="hl lin">   91 </span>        <span class="hl kwa">while True</span><span class="hl opt">:</span>
<span class="hl lin">   92 </span>
<span class="hl lin">   93 </span>            rows <span class="hl opt">= []</span>
<span class="hl lin">   94 </span>
<span class="hl lin">   95 </span>            <span class="hl slc"># read following lines from input</span>
<span class="hl lin">   96 </span>            <span class="hl slc"># (1 empty line, 5 lines with content)</span>
<span class="hl lin">   97 </span>            <span class="hl kwa">for</span> line <span class="hl kwa">in</span> <span class="hl kwd">islice</span><span class="hl opt">(</span>lines<span class="hl opt">,</span> <span class="hl num">1</span> <span class="hl opt">+</span> <span class="hl num">5</span><span class="hl opt">):</span>
<span class="hl lin">   98 </span>                rows <span class="hl opt">+= [</span><span class="hl kwb">int</span><span class="hl opt">(</span>i<span class="hl opt">)</span> <span class="hl kwa">for</span> i <span class="hl kwa">in</span> line<span class="hl opt">.</span><span class="hl kwd">split</span><span class="hl opt">()]</span>
<span class="hl lin">   99 </span>
<span class="hl lin">  100 </span>            <span class="hl kwa">if</span> rows<span class="hl opt">:</span>
<span class="hl lin">  101 </span>                <span class="hl kwa">assert</span> <span class="hl kwb">len</span><span class="hl opt">(</span>rows<span class="hl opt">) ==</span> <span class="hl num">5</span> <span class="hl opt">*</span> <span class="hl num">5</span>
<span class="hl lin">  102 </span>                board <span class="hl opt">=</span> np<span class="hl opt">.</span><span class="hl kwd">resize</span><span class="hl opt">(</span>np<span class="hl opt">.</span><span class="hl kwd">array</span><span class="hl opt">(</span>rows<span class="hl opt">), (</span><span class="hl num">5</span><span class="hl opt">,</span> <span class="hl num">5</span><span class="hl opt">))</span>
<span class="hl lin">  103 </span>                boards<span class="hl opt">.</span><span class="hl kwd">append</span><span class="hl opt">(</span>board<span class="hl opt">)</span>
<span class="hl lin">  104 </span>            <span class="hl kwa">else</span><span class="hl opt">:</span>
<span class="hl lin">  105 </span>                <span class="hl slc"># no input left, leave loop</span>
<span class="hl lin">  106 </span>                <span class="hl kwa">break</span>
<span class="hl lin">  107 </span>
<span class="hl lin">  108 </span>    <span class="hl kwa">return</span> draws_all<span class="hl opt">,</span> boards
<span class="hl lin">  109 </span>
<span class="hl lin">  110 </span>
<span class="hl lin">  111 </span><span class="hl kwa">def</span> <span class="hl kwd">is_board_winning</span><span class="hl opt">(</span>board<span class="hl opt">,</span> draws<span class="hl opt">):</span>
<span class="hl lin">  112 </span>    <span class="hl sng">&quot;&quot;&quot;</span>
<span class="hl lin">  113 </span><span class="hl sng">    Checks if a board can win with regard to currently drawn numbers.</span>
<span class="hl lin">  114 </span><span class="hl sng">    A board wins if all of the numbers of one row or one column are drawn.</span>
<span class="hl lin">  115 </span><span class="hl sng">    &quot;&quot;&quot;</span>
<span class="hl lin">  116 </span>
<span class="hl lin">  117 </span>    <span class="hl slc"># The rows of a transposed board are the columns of the not transposed board</span>
<span class="hl lin">  118 </span>    <span class="hl kwa">return</span> <span class="hl kwd">check_rows</span><span class="hl opt">(</span>board<span class="hl opt">,</span> draws<span class="hl opt">)</span> <span class="hl kwa">or</span> <span class="hl kwd">check_rows</span><span class="hl opt">(</span>board<span class="hl opt">.</span><span class="hl kwd">transpose</span><span class="hl opt">(),</span> draws<span class="hl opt">)</span>
<span class="hl lin">  119 </span>
<span class="hl lin">  120 </span>
<span class="hl lin">  121 </span><span class="hl kwa">def</span> <span class="hl kwd">check_rows</span><span class="hl opt">(</span>board<span class="hl opt">,</span> draws<span class="hl opt">):</span>
<span class="hl lin">  122 </span>    <span class="hl kwa">for</span> row <span class="hl kwa">in</span> board<span class="hl opt">:</span>
<span class="hl lin">  123 </span>        <span class="hl kwa">assert</span> <span class="hl kwb">len</span><span class="hl opt">(</span><span class="hl kwb">set</span><span class="hl opt">(</span>row<span class="hl opt">)) ==</span> <span class="hl num">5</span>
<span class="hl lin">  124 </span>        <span class="hl kwa">if</span> <span class="hl kwb">set</span><span class="hl opt">(</span>row<span class="hl opt">).</span><span class="hl kwd">issubset</span><span class="hl opt">(</span>draws<span class="hl opt">):</span>
<span class="hl lin">  125 </span>            <span class="hl kwa">return True</span>
<span class="hl lin">  126 </span>    <span class="hl kwa">return False</span>
<span class="hl lin">  127 </span>
<span class="hl lin">  128 </span>
<span class="hl lin">  129 </span><span class="hl kwa">def</span> <span class="hl kwd">sum_of_unmarked_fields</span><span class="hl opt">(</span>board<span class="hl opt">,</span> draws<span class="hl opt">):</span>
<span class="hl lin">  130 </span>    <span class="hl sng">&quot;&quot;&quot;calculate the sum of all unmarked numbers of a winning board&quot;&quot;&quot;</span>
<span class="hl lin">  131 </span>
<span class="hl lin">  132 </span>    unmarked <span class="hl opt">= []</span>
<span class="hl lin">  133 </span>    <span class="hl kwa">for</span> item <span class="hl kwa">in</span> board<span class="hl opt">.</span>flat<span class="hl opt">:</span>
<span class="hl lin">  134 </span>        <span class="hl kwa">if</span> item <span class="hl kwa">not in</span> draws<span class="hl opt">:</span>
<span class="hl lin">  135 </span>            unmarked<span class="hl opt">.</span><span class="hl kwd">append</span><span class="hl opt">(</span>item<span class="hl opt">)</span>
<span class="hl lin">  136 </span>
<span class="hl lin">  137 </span>    <span class="hl kwa">return</span> <span class="hl kwb">sum</span><span class="hl opt">(</span>unmarked<span class="hl opt">)</span>
<span class="hl lin">  138 </span>
<span class="hl lin">  139 </span>
<span class="hl lin">  140 </span><span class="hl kwa">if</span> __name__ <span class="hl opt">==</span> <span class="hl sng">&#39;__main__&#39;</span><span class="hl opt">:</span>
<span class="hl lin">  141 </span>    <span class="hl kwd">main</span><span class="hl opt">()</span>
</pre>
</body>
</html>
<!--HTML generated by highlight 4.1, http://www.andre-simon.de/-->
